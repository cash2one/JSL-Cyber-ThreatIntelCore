import BeautifulSoup as bs
import urllib3

URL = "http://cybercrime-tracker.net/index.php?s=0&m=400000"


def parse_cyberCrime(url):
    '''
    :param url:
    :return list of IP addresses:
    '''
    http = urllib3.PoolManager()
    doc = http.request('GET', url).data

    soup = bs.BeautifulSoup(doc)
    soup = soup.findAll('table')[0]

    spamlist = []

    for row in soup.findAll('tr'):

        aux = row.findAll('td')

        if len(aux) > 1 and aux[0].string is not None:
            spam = {}
            #print aux[0].string, aux[1].string, aux[2].string, aux[3].string
            spam['ip_address'] = aux[2].string
            spam['host_name'] = aux[1].string
            spam['listing_timestamp'] = aux[0].string

            if aux[3].string:
                spam[aux[3].string] = '1'
            else:
                spam['unknown'] = '1'
            spamlist.append(spam)

    return spamlist

'''
blacklist = parse_malware_domains(URL)

for element in blacklist:
    print element
'''