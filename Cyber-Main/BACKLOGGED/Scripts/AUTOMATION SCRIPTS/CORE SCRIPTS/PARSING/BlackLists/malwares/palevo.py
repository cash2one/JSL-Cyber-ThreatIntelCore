import BeautifulSoup as bs
import urllib3
URL = "https://palevotracker.abuse.ch/"


def palveo_ips(url):
    '''

    :param url:
    :return A list of Lists (20x2) : IP Address, Rank :
    '''
    spamlist = []
    http = urllib3.PoolManager()
    doc = http.request('GET', url).data

    soup = bs.BeautifulSoup(doc)


    soup = soup.findAll('table')[0]
    for row in soup.findAll('tr'):

        aux = row.findAll('td')

        if len(aux) > 1 and aux[1].find('a') is not None:
            spam = {}
            spam['palevo_tracker'] = "1"
            spam['feodo_tracker'] = "0"
            spam['spyeye_tracker'] = "0"
            spam['zeus_tracker'] = "0"
            spam['ip_address'] = aux[2].string
            spam['listing_date'] = aux[0].string
            spam['host_name'] = aux[1].find('a').string
            spam['country'] = aux[7].find('img')['alt']
            spam['autonomous_system_number'] = aux[5].string
            spam['autonomous_system_name'] = aux[6].string
            print spam
            spamlist.append(spam)




    return spamlist


palveo_ips(URL)