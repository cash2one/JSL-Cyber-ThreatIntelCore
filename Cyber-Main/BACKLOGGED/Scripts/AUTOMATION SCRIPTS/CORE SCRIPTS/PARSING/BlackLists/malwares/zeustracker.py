import urllib3

URL_IPS = "https://zeustracker.abuse.ch/blocklist.php?download=ipblocklist"
URL_DOMAINS = "https://zeustracker.abuse.ch/blocklist.php?download=baddomains"

def parse_zeus_ips(url):
    '''

    :param url:
    :return A list of IP addresses:
    '''

    http = urllib3.PoolManager()
    doc = http.request('GET', url).data
    doc = doc.split('\n')

    doc = doc[6:]
    ips = []
    for i in range(len(doc)):
        doc[i] = doc[i][:-1]
        if doc[i] is not '':
            ips.append({'ip_address': doc[i]})
    return ips


def parse_zeus_domains(url):
    '''

    :param url:
    :return A list of domain Names:
    '''

    http = urllib3.PoolManager()
    doc = http.request('GET', url).data
    doc = doc.split('\n')

    doc = doc[6:]
    domains = []
    for i in range(len(doc)):

        doc[i] = doc[i][:-1]
        if doc[i] is not '':
            domains.append({'host_name': doc[i]})
    return domains

'''
blacklist = parse_zeus_domains(URL_DOMAINS)

for element in blacklist:
    print element
'''